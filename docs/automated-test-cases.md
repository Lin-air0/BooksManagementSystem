# 图书借阅系统自动化测试用例

## 1. 借阅流程测试用例

**用例编号**: TC001
**用例目标**: 验证读者能够成功借阅存在库存的图书，且系统正确扣减库存
**测试环境**: 开发环境

**测试步骤**:
1. 准备测试数据：确保系统中存在一本库存大于0的图书（例如：书名《三体》，库存5本）和一名有效的读者（读者ID: 1001）
2. 调用POST /api/borrows接口，提交借阅请求（参数：readerId=1001，bookId=1）
3. 验证接口返回成功状态码（201）
4. 查询borrows表，确认新增一条借阅记录
5. 查询books表，确认该图书库存减少1本（从5变为4）

**预期结果**: 借阅成功，borrows表新增记录，图书库存减1

## 2. 还书流程测试用例

**用例编号**: TC002
**用例目标**: 验证读者能够成功归还已借阅的图书，且系统正确恢复库存
**测试环境**: 开发环境

**测试步骤**:
1. 准备测试数据：确保系统中存在一条未归还的借阅记录（borrowId=1，readerId=1001，bookId=1）
2. 调用PUT /api/borrows/return/:id接口，提交还书请求（参数：id=1）
3. 验证接口返回成功状态码（200）
4. 查询borrows表，确认该借阅记录状态更新为"已归还"
5. 查询books表，确认该图书库存增加1本

**预期结果**: 还书成功，借阅记录状态更新，图书库存恢复

## 3. 多条件查询流程测试用例

**用例编号**: TC003
**用例目标**: 验证系统能够正确处理组合查询条件，返回符合条件的图书列表
**测试环境**: 开发环境

**测试步骤**:
1. 准备测试数据：确保系统中存在分类为"文学"且书名包含"三体"的图书
2. 调用GET /api/books接口，提交查询请求（参数：category=文学，keyword=三体）
3. 验证接口返回成功状态码（200）
4. 检查返回的图书列表，确认包含《三体》
5. 确认返回的所有图书分类均为"文学"

**预期结果**: 查询成功，返回符合分类和关键词条件的图书列表

## 4. 逾期还书流程测试用例

**用例编号**: TC004
**用例目标**: 验证系统能够正确识别逾期归还的图书，并计算逾期罚款
**测试环境**: 开发环境

**测试步骤**:
1. 准备测试数据：确保系统中存在一条已逾期的借阅记录（borrowId=2，借阅日期为7天前，应还日期为3天前）
2. 调用PUT /api/borrows/return/:id接口，提交还书请求（参数：id=2）
3. 验证接口返回成功状态码（200）
4. 查询borrows表，确认该借阅记录状态更新为"已归还"，且逾期天数和罚款金额正确计算

**预期结果**: 还书成功，系统正确识别逾期并计算罚款

## 5. 借阅不存在图书测试用例

**用例编号**: TC005
**用例目标**: 验证系统能够正确处理借阅不存在图书的请求
**测试环境**: 开发环境

**测试步骤**:
1. 调用POST /api/borrows接口，提交借阅请求（参数：readerId=1001，bookId=9999）
2. 验证接口返回错误状态码（404）
3. 确认错误信息提示"图书不存在"

**预期结果**: 借阅失败，系统返回404错误和相应提示信息

## 6. 库存为0图书借阅测试用例

**用例编号**: TC006
**用例目标**: 验证系统能够正确处理借阅库存为0图书的请求
**测试环境**: 开发环境

**测试步骤**:
1. 准备测试数据：确保系统中存在一本库存为0的图书（bookId=3）
2. 调用POST /api/borrows接口，提交借阅请求（参数：readerId=1001，bookId=3）
3. 验证接口返回错误状态码（400）
4. 确认错误信息提示"图书库存不足"

**预期结果**: 借阅失败，系统返回400错误和相应提示信息